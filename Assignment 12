;Andres Arevalo
;CIS-11

ExitProcess Proto
ReadInt64 Proto
WriteInt64 Proto
Crlf Proto

.data
MyArray QWORD 10d, 20d, 30d, 40d
FinalArray QWORD 4 DUP (0) ; initialized array to 0 each element
.code
main proc

mov rsi, 0
mov r15, 8 ; hard code


	; print out the array numbers
	mov rcx, 4
    mov rsi, 0

	startLoop:
	mov rax, rsi ; i = 0
	mul r15 ; i = i * 8
	mov rdi, rax
	mov rax, MyArray[rdi] ; var = MyArray[i]
	call WriteInt64 
	inc rsi ;i++
		Loop startLoop
	call Crlf

	mov rcx, 4
    mov rsi, 0

	MyLoop:
	
	mov rax, rsi
	mul r15 ; mul uses rax can't use ints must mul registers directly
	mov rdx, qword ptr myArray[rax]; rdx has current value 

	inc rsi 
	cmp rsi, 4
	je HandleLast

	mov FinalArray [rax + 8], rdx
	jmp EndLoop

	HandleLast:
	mov finalArray[0], rdx ; this is changing the array

	EndLoop:

	Loop MyLoop

	mov rcx, 4
    mov rsi, 0

	finalLoop:
	mov rax, rsi 
	mul r15 
	mov rdi, rax
	mov rax, FinalArray[rdi] 
	call WriteInt64 
	inc rsi 
		Loop finalLoop

	call ReadInt64
	call ExitProcess
main endp
end
